(this["webpackJsonpnikes-on-my-feet-client"]=this["webpackJsonpnikes-on-my-feet-client"]||[]).push([[0],{66:function(e,n,t){},69:function(e,n,t){"use strict";t.r(n);var a=t(2),c=t.n(a),r=t(53),s=t.n(r),i=(t(66),t(19)),o=t(22),l=t(5),j=t(58),d=t(80),u=t(82),b=t(79),h=t(56),m=t(54),O=t(55),p=t(42),v=new(function(){function e(){Object(m.a)(this,e)}return Object(O.a)(e,[{key:"getProfile",value:function(){return Object(p.a)(this.getToken())}},{key:"loggedIn",value:function(){var e=this.getToken();return!!e&&!this.isTokenExpired(e)}},{key:"isTokenExpired",value:function(e){try{return Object(p.a)(e).exp<Date.now()/1e3}catch(n){return!1}}},{key:"getToken",value:function(){return localStorage.getItem("id_token")}},{key:"login",value:function(e){localStorage.setItem("id_token",e),window.location.assign("/")}},{key:"logout",value:function(){localStorage.removeItem("id_token"),window.location.assign("/")}}]),e}()),x=t(3);var g,f,w,y,k,N,S=function(){return Object(x.jsx)("nav",{className:"text-center",children:v.loggedIn()?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(o.b,{to:"/profile",children:"Me"}),Object(x.jsx)("a",{href:"/",onClick:logout,children:"Logout"})]}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(o.b,{to:"/login",children:"Login"}),Object(x.jsx)(o.b,{to:"/signup",children:"Signup"})]})})},_=function(){return Object(x.jsx)("header",{className:"bg-secondary mb-4 py-2 flex-row align-center",children:Object(x.jsxs)("div",{className:"container flex-row justify-space-between-lg justify-center align-center",children:[Object(x.jsx)(o.b,{to:"/",children:Object(x.jsx)("h1",{children:"Nikes On My Feet"})}),v.loggedIn()?Object(x.jsx)(x.Fragment,{children:Object(x.jsx)("a",{href:"/",onClick:function(e){e.preventDefault(),v.logout()},children:"Logout"})}):Object(x.jsx)(S,{})]})})},I=t(84),$=t(23),C=t(81),D=Object(C.a)(g||(g=Object($.a)(["\n  query Query {\n    shoes {\n      _id\n      shoe_name\n      price\n      shoe_description\n      shoe_size\n      photo_ref\n      gender\n      reviews {\n        _id\n        reviewBody\n        username\n      }\n    }\n  }\n"]))),B=(Object(C.a)(f||(f=Object($.a)(["\n  query user($username: String!) {\n    user(username: $username) {\n      _id\n      username\n      email\n    }\n  }\n"]))),Object(C.a)(w||(w=Object($.a)(["\n  {\n    me {\n      _id\n      username\n      email\n    }\n  }\n"]))),t(21)),L=t(29),F=t(10),T=t(76),z=Object(C.a)(y||(y=Object($.a)(["\n  mutation login($email: String!, $password: String!) {\n    login(email: $email, password: $password) {\n      token\n      user {\n        _id\n        username\n      }\n    }\n  }\n"]))),P=Object(C.a)(k||(k=Object($.a)(["\n  mutation addUser($username: String!, $email: String!, $password: String!) {\n    addUser(username: $username, email: $email, password: $password) {\n      token\n      user {\n        _id\n        username\n      }\n    }\n  }\n"]))),M=Object(C.a)(N||(N=Object($.a)(["\n  mutation addReview($shoeId: ID!, $reviewBody: String!) {\n    addReview(shoeId: $shoeId, reviewBody: $reviewBody) {\n      reviews {\n        _id\n      }\n    }\n  }\n"])));function U(e){var n=Object(a.useState)(!1),t=Object(F.a)(n,2),c=t[0],r=t[1],s=Object(a.useState)(""),i=Object(F.a)(s,2),o=i[0],l=i[1],j=Object(a.useState)(0),d=Object(F.a)(j,2),u=(d[0],d[1]),b=Object(T.a)(M),h=Object(F.a)(b,2),m=h[0],O=(h[1].error,e.shoeId);console.log("body: "+o,"ID: "+O);var p,g=function(){var e=Object(L.a)(Object(B.a)().mark((function e(n){return Object(B.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,m({variables:{reviewBody:o,shoeId:O}});case 4:l(""),r(!1),u(0),window.location.reload(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(n){return e.apply(this,arguments)}}(),f=Math.floor(Math.random()*e.review.length);return Object(x.jsxs)("div",{className:"card",children:[Object(x.jsx)("div",{className:"card-header",children:Object(x.jsx)("span",{className:"text-light",children:e.shoeName})}),Object(x.jsxs)("div",{className:"card-body flex-row",children:[Object(x.jsx)("div",{className:"card-photo-holder",children:Object(x.jsx)("img",{src:"./images/shoes/".concat(e.photo),alt:"A Shoe"})}),Object(x.jsxs)("div",{className:"card-info-holder col-12 col-lg-8",children:[Object(x.jsx)("p",{children:e.shoeDisc}),Object(x.jsxs)("p",{children:["Size: ",e.shoeSize]}),Object(x.jsx)("p",{children:(p=e.gender,p.charAt(0).toUpperCase()+p.slice(1))}),Object(x.jsxs)("h3",{children:["Price: $",e.shoePrice]}),v.loggedIn()&&!c?Object(x.jsx)("button",{className:"btn",onClick:function(){r(!0)},children:"Leave Review"}):Object(x.jsx)("p",{}),1==c&&Object(x.jsxs)("div",{className:"flex-row",children:[Object(x.jsx)("textarea",{placeholder:"Leave a review about this shoe",value:o,onChange:function(e){e.target.value.length<=280&&(l(e.target.value),u(e.target.value.length))}}),Object(x.jsx)("button",{className:"btn ml-3",onClick:g,children:"Submit"})]})]})]}),void 0!==e.review[0]?Object(x.jsx)("div",{className:"ml-4",children:Object(x.jsxs)("p",{children:[e.review[f].username," said:"," ",e.review[f].reviewBody]})}):Object(x.jsx)("p",{})]})}function q(){var e=Object(I.a)(D),n=(e.loading,e.data),t=(null===n||void 0===n?void 0:n.shoes)||[];return Object(x.jsx)("main",{children:t.map((function(e){return console.log(e),Object(x.jsx)(U,{shoeId:e._id,shoeName:e.shoe_name,shoePrice:e.price,shoeDisc:e.shoe_description,shoeSize:e.shoe_size,photo:e.photo_ref,gender:e.gender,review:e.reviews})}))})}var E=t(28),R=function(e){var n=Object(a.useState)({email:"",password:""}),t=Object(F.a)(n,2),c=t[0],r=t[1],s=Object(T.a)(z),o=Object(F.a)(s,2),l=o[0],j=o[1].error,d=function(e){var n=e.target,t=n.name,a=n.value;r(Object(i.a)(Object(i.a)({},c),{},Object(E.a)({},t,a)))},u=function(){var e=Object(L.a)(Object(B.a)().mark((function e(n){var t,a;return Object(B.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,l({variables:Object(i.a)({},c)});case 4:t=e.sent,a=t.data,v.login(a.login.token),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:r({email:"",password:""});case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(n){return e.apply(this,arguments)}}();return Object(x.jsx)("main",{className:"flex-row justify-center mb-4",children:Object(x.jsx)("div",{className:"col-12 col-md-6",children:Object(x.jsxs)("div",{className:"card",children:[Object(x.jsx)("h4",{className:"card-header",children:"Login"}),Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsxs)("form",{onSubmit:u,children:[Object(x.jsx)("input",{className:"form-input",placeholder:"Your email",name:"email",type:"email",id:"email",value:c.email,onChange:d}),Object(x.jsx)("input",{className:"form-input",placeholder:"******",name:"password",type:"password",id:"password",value:c.password,onChange:d}),Object(x.jsx)("button",{className:"btn d-block w-100",type:"submit",children:"Submit"})]}),j&&Object(x.jsx)("div",{children:"Login failed"})]})]})})})},Y=function(){var e=Object(a.useState)({username:"",email:"",password:""}),n=Object(F.a)(e,2),t=n[0],c=n[1],r=Object(T.a)(P),s=Object(F.a)(r,2),o=s[0],l=s[1].error,j=function(e){var n=e.target,a=n.name,r=n.value;c(Object(i.a)(Object(i.a)({},t),{},Object(E.a)({},a,r)))},d=function(){var e=Object(L.a)(Object(B.a)().mark((function e(n){var a,c;return Object(B.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,o({variables:Object(i.a)({},t)});case 4:a=e.sent,c=a.data,v.login(c.addUser.token),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(n){return e.apply(this,arguments)}}();return Object(x.jsx)("main",{className:"flex-row justify-center mb-4",children:Object(x.jsx)("div",{className:"col-12 col-md-6",children:Object(x.jsxs)("div",{className:"card",children:[Object(x.jsx)("h4",{className:"card-header",children:"Sign Up"}),Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsxs)("form",{onSubmit:d,children:[Object(x.jsx)("input",{className:"form-input",placeholder:"Your username",name:"username",type:"username",id:"username",value:t.username,onChange:j}),Object(x.jsx)("input",{className:"form-input",placeholder:"Your email",name:"email",type:"email",id:"email",value:t.email,onChange:j}),Object(x.jsx)("input",{className:"form-input",placeholder:"******",name:"password",type:"password",id:"password",value:t.password,onChange:j}),Object(x.jsx)("button",{className:"btn d-block w-100",type:"submit",children:"Submit"})]}),l&&Object(x.jsx)("div",{children:"Signup failed"})]})]})})})},A=Object(j.a)({uri:"http://localhost:3001/graphql"}),J=Object(h.a)((function(e,n){var t=n.headers,a=localStorage.getItem("id_token");return{headers:Object(i.a)(Object(i.a)({},t),{},{authorization:a?"Bearer ".concat(a):""})}})),Q=new d.a({link:J.concat(A),cache:new u.a});var G=function(){return Object(x.jsx)(b.a,{client:Q,children:Object(x.jsxs)(o.a,{children:[Object(x.jsx)(_,{}),Object(x.jsx)("div",{className:"container",children:Object(x.jsxs)(l.c,{children:[Object(x.jsx)(l.a,{path:"/",element:Object(x.jsx)(q,{})}),Object(x.jsx)(l.a,{path:"/login",element:Object(x.jsx)(R,{})}),Object(x.jsx)(l.a,{path:"/signup",element:Object(x.jsx)(Y,{})})]})})]})})},H=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,85)).then((function(n){var t=n.getCLS,a=n.getFID,c=n.getFCP,r=n.getLCP,s=n.getTTFB;t(e),a(e),c(e),r(e),s(e)}))};s.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsx)(G,{})}),document.getElementById("root")),H(console.log)}},[[69,1,2]]]);
//# sourceMappingURL=main.4d4bc759.chunk.js.map